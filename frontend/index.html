<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PhotoMap v0.6.5 - Stability & Performance Edition</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
    <link rel="stylesheet" href="/style.css" />
</head>
<body>
    <!-- Full-screen Map -->
    <div id="map" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 1;"></div>

    <!-- Floating Info Window -->
    <div id="floating-info-window" style="position: fixed; top: 0; right: 0; width: 440px; background: white; border-left: 2px solid #ccc; border-bottom: 2px solid #ccc; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.2);">
        <!-- Title Bar (always visible) -->
        <div id="window-title-bar" style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8f9fa; border-bottom: 1px solid #ddd; cursor: default;">
            <span style="font-size: 12px; font-weight: bold; color: #333;">üó∫Ô∏è PhotoMap v0.6.5</span>
            <button id="toggle-window-btn" style="background: #007bff; color: white; border: none; padding: 2px 6px; border-radius: 3px; cursor: pointer; font-size: 10px;">‚åÑ</button>
        </div>

        <!-- Content Area (expandable) -->
        <div id="window-content" style="height: auto; max-height: calc(100vh - 30px); overflow-y: auto;">
            <!-- HEIC_WARNING_PLACEHOLDER -->
                <!-- Control Panel -->
                <div id="control-panel" style="padding: 15px; box-sizing: border-box;">
                    <h3 style="margin: 0 0 10px 0; color: #333; font-size: 14px;">PhotoMap Controls</h3>

                <!-- Folder Selection -->
                <!-- Folder Path Input -->
                <div style="margin-bottom: 10px;">
                    <label for="folder-input" style="display: block; margin-bottom: 5px; font-weight: bold;">üìÅ Folder Path:</label>
                    <input type="text" id="folder-input" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box;" placeholder="/Users/user/Photos/my_folder">
                </div>

                <!-- Processing Controls -->
                <div style="margin-bottom: 10px;">
                    <button id="process-button" onclick="processFolder()" style="background: #28a745; color: white; border: none; padding: 10px 15px; border-radius: 4px; cursor: pointer; width: 100%;">
                        üöÄ Process Photos
                    </button>
                </div>

                <!-- Year Range Controls -->
                <div style="margin-bottom: 10px;">
                    <div style="display: flex; align-items: center; gap: 8px; font-size: 0.9em;">
                        <strong style="white-space: nowrap;">–û—Ç:</strong>
                        <input type="number" id="year-from" style="width: 70px; padding: 4px; border: 1px solid #ddd; border-radius: 3px;" min="1900" max="2100" step="1" autocomplete="off" spellcheck="false" data-lpignore="true" data-form-type="other" role="presentation">
                        <strong style="white-space: nowrap;">–î–æ:</strong>
                        <input type="number" id="year-to" style="width: 70px; padding: 4px; border: 1px solid #ddd; border-radius: 3px;" min="1900" max="2100" step="1" autocomplete="off" spellcheck="false" data-lpignore="true" data-form-type="other" role="presentation">
                    </div>
                </div>

                <!-- Processing Status -->
                <div id="processing-status" style="margin-bottom: 10px; padding: 10px; background: #f8f9fa; border-radius: 4px; display: none;">
                    <div id="status-text" style="font-weight: bold;">–û–±—Ä–∞–±–æ—Ç–∫–∞...</div>
                    <div id="progress-text" style="font-size: 0.9em; color: #666;"></div>
                </div>

                <!-- Statistics Display -->
                <div id="statistics-panel" style="margin-bottom: 10px; padding: 12px; background: #f0f8ff; border-radius: 6px; border: 1px solid #ddd;">
                    <h4 style="margin: 0 0 8px 0; color: #333; font-size: 1.0em;">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h4>
                    <div style="font-size: 0.9em; line-height: 1.6;">
                        <div style="margin-bottom: 4px;"><strong>–í—Å–µ–≥–æ —Ñ–æ—Ç–æ:</strong> <span id="total-photos">-</span></div>
                        <div style="margin-bottom: 4px;"><strong>–û—Ç–æ–±—Ä–∞–∂–µ–Ω–æ:</strong> <span id="visible-photos">-</span></div>
                    </div>
                </div>
        </div> <!-- control-panel -->
        </div> <!-- window-content -->
    </div> <!-- floating-info-window -->

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
    <script src="/script.js"></script>
</body>
</html>