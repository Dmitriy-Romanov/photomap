<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PhotoMap</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
    <link rel="stylesheet" href="/style.css" />
</head>

<body>
    <!-- Full-screen Map -->
    <div id="map"></div>

    <!-- Floating Info Window -->
    <div id="floating-info-window" class="info-panel">
        <!-- Title Bar -->
        <div class="panel-header">
            <div class="app-title">
                <span>üó∫Ô∏è</span> PhotoMap
            </div>
            <label class="map-coords-toggle">
                <span class="toggle-label">Map coord:</span>
                <input type="checkbox" id="coords-toggle" checked>
            </label>
            <div class="coords-wrapper">
                <span id="map-coordinates" class="map-coordinates">Lat: 0.00000, Lon: 0.00000</span>
            </div>
            <div class="window-controls">
                <button id="toggle-window-btn" class="control-btn" onclick="toggleInfoWindow()" title="Minimize">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </button>
                <button class="control-btn close" onclick="shutdownApp()" title="Close App">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Content Area -->
        <div id="window-content" class="panel-content">
            <!-- Processing Status Overlay -->
            <div id="processing-status" class="processing-overlay">
                <div class="spinner"></div>
                <div style="text-align: center;">
                    <div id="status-text">Processing...</div>
                    <div id="progress-text">Initializing...</div>
                </div>
            </div>

            <!-- Folder Selection -->
            <div class="control-group">
                <label class="group-label">Source Folder</label>
                <div class="input-wrapper">
                    <input type="text" id="folder-input" class="folder-input" placeholder="No folder selected" readonly>
                    <button id="open-button" class="icon-btn primary" onclick="openFolderDialog()" title="Open Folder">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z">
                            </path>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Year Range with Statistics -->
            <div class="year-range-row">
                <div class="year-range-left">
                    <label class="group-label">
                        Year Range
                        <span id="year-range-info" class="year-range-info"></span>
                    </label>
                    <div class="year-inputs">
                        <div class="year-field">
                            <label>From</label>
                            <input type="number" id="year-from" min="1900" max="2100" placeholder="YYYY">
                        </div>
                        <span class="year-separator">‚Äî</span>
                        <div class="year-field">
                            <label>To</label>
                            <input type="number" id="year-to" min="1900" max="2100" placeholder="YYYY">
                        </div>
                    </div>
                </div>

                <!-- Statistics (inline) -->
                <div class="stats-bar">
                    <div class="stat-item">
                        <span class="stat-label">Total Photos</span>
                        <span id="total-photos" class="stat-value">-</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Visible on Map</span>
                        <span id="visible-photos" class="stat-value">-</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
    <script src="/script.js"></script>
</body>

</html>